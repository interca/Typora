# 微服务



## 一、介绍    

### 1、技术栈    

![微信截图_20221014033117](https://gitee.com/hongshenghyj/typora/raw/master/img/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20221014033117.png)

   

分类学习

![微信截图_20221014033312](https://gitee.com/hongshenghyj/typora/raw/master/img/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20221014033312.png)

​    





### 2、学习内容  

![微信截图_20221014033503](https://gitee.com/hongshenghyj/typora/raw/master/img/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20221014033503.png)

  



### 3、结构    

单体

![微信截图_20221014202939](https://gitee.com/hongshenghyj/typora/raw/master/img/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20221014202939.png)

​    

![微信截图_20221014203250](https://gitee.com/hongshenghyj/typora/raw/master/img/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20221014203250.png)

  

![微信截图_20221014204504](https://gitee.com/hongshenghyj/typora/raw/master/img/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20221014204504.png)

  



![微信截图_20221014204926](https://gitee.com/hongshenghyj/typora/raw/master/img/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20221014204926.png)

 

技术对比

![微信截图_20221229005245](https://gitee.com/hongshenghyj/typora/raw/master/img/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20221229005245.png)





![微信截图_20221014210135](https://gitee.com/hongshenghyj/typora/raw/master/img/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20221014210135.png)





### 4、cloud  

![微信截图_20221014210727](https://gitee.com/hongshenghyj/typora/raw/master/img/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20221014210727.png)



![微信截图_20221014211140](https://gitee.com/hongshenghyj/typora/raw/master/img/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20221014211140.png)

  



## 二、远程调用

### 1、概念

![微信截图_20221014211423](https://gitee.com/hongshenghyj/typora/raw/master/img/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20221014211423.png)

​    



![微信截图_20221014231702](https://gitee.com/hongshenghyj/typora/raw/master/img/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20221014231702.png)

  



![微信截图_20221014231813](https://gitee.com/hongshenghyj/typora/raw/master/img/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20221014231813.png)







### 2、restemplate

先注入bean

![微信截图_20221014231849](https://gitee.com/hongshenghyj/typora/raw/master/img/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20221014231849.png)

  

这里是订单的查询模块

然后通过请求地址查询用户模块的接口

最后再组合

![微信截图_20221014232736](https://gitee.com/hongshenghyj/typora/raw/master/img/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20221014232736.png)

  



### 3、注册中心  Eureka

![微信截图_20221014233807](https://gitee.com/hongshenghyj/typora/raw/master/img/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20221014233807.png)

  

![微信截图_20221014234245](https://gitee.com/hongshenghyj/typora/raw/master/img/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20221014234245.png)

  

简单来说就是生产者和消费者不直接交流  要通过注册中心间接交流

![微信截图_20221014235158](https://gitee.com/hongshenghyj/typora/raw/master/img/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20221014235158.png)

​    



![微信截图_20221015001527](https://gitee.com/hongshenghyj/typora/raw/master/img/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20221015001527.png)





### 4、搭建eureka    



![微信截图_20221015015823](https://gitee.com/hongshenghyj/typora/raw/master/img/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20221015015823.png)

  



#### 搭建

![微信截图_20221015015930](https://gitee.com/hongshenghyj/typora/raw/master/img/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20221015015930.png)





![微信截图_20221015023438](https://gitee.com/hongshenghyj/typora/raw/master/img/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20221015023438.png)



![微信截图_20221015023455](https://gitee.com/hongshenghyj/typora/raw/master/img/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20221015023455.png)





#### 注册服务

![微信截图_20221019223120](https://gitee.com/hongshenghyj/typora/raw/master/img/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20221019223120.png)





![微信截图_20221020002218](https://gitee.com/hongshenghyj/typora/raw/master/img/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20221020002218.png)



#### yml

![微信截图_20221020002227](https://gitee.com/hongshenghyj/typora/raw/master/img/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20221020002227.png)



模拟

![微信截图_20221020002736](https://gitee.com/hongshenghyj/typora/raw/master/img/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20221020002736.png)

  



#### 服务拉取

![微信截图_20221020003241](https://gitee.com/hongshenghyj/typora/raw/master/img/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20221020003241.png)



这里用服务名称代替端口号和ip地址  访问用户模块的接口

![微信截图_20221020003507](https://gitee.com/hongshenghyj/typora/raw/master/img/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20221020003507.png)

  

![微信截图_20221020003545](https://gitee.com/hongshenghyj/typora/raw/master/img/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20221020003545.png)

 



#### 总结

![微信截图_20221020004214](https://gitee.com/hongshenghyj/typora/raw/master/img/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20221020004214.png)







### 5、负载均衡  

  ![微信截图_20221020011032](https://gitee.com/hongshenghyj/typora/raw/master/img/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20221020011032.png)



![微信截图_20221020111532](https://gitee.com/hongshenghyj/typora/raw/master/img/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20221020111532.png)





![微信截图_20221020111825](https://gitee.com/hongshenghyj/typora/raw/master/img/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20221020111825.png)





![微信截图_20221020112240](https://gitee.com/hongshenghyj/typora/raw/master/img/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20221020112240.png)





![微信截图_20221020112557](https://gitee.com/hongshenghyj/typora/raw/master/img/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20221020112557.png)





![微信截图_20221020115607](https://gitee.com/hongshenghyj/typora/raw/master/img/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20221020115607.png)





![微信截图_20221020115800](https://gitee.com/hongshenghyj/typora/raw/master/img/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20221020115800.png)





## 三、nacos

### 1、介绍  

![微信截图_20221021143417](https://gitee.com/hongshenghyj/typora/raw/master/img/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20221021143417.png)

  

安装和启动看另一个笔记





### 2、服务注册

在父工程添加这些依赖

![微信截图_20221021145310](https://gitee.com/hongshenghyj/typora/raw/master/img/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20221021145310.png)





![微信截图_20221021145420](https://gitee.com/hongshenghyj/typora/raw/master/img/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20221021145420.png)



配置

![微信截图_20221021151515](https://gitee.com/hongshenghyj/typora/raw/master/img/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20221021151515.png)







### 3、集群  



![微信截图_20221022010904](https://gitee.com/hongshenghyj/typora/raw/master/img/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20221022010904.png)



![微信截图_20221022011019](https://gitee.com/hongshenghyj/typora/raw/master/img/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20221022011019.png)



![微信截图_20221022011533](https://gitee.com/hongshenghyj/typora/raw/master/img/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20221022011533.png)





![微信截图_20221022011543](https://gitee.com/hongshenghyj/typora/raw/master/img/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20221022011543.png)



负载均衡

![微信截图_20221022012743](https://gitee.com/hongshenghyj/typora/raw/master/img/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20221022012743.png)





![微信截图_20221022013518](https://gitee.com/hongshenghyj/typora/raw/master/img/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20221022013518.png)





![微信截图_20221022013556](https://gitee.com/hongshenghyj/typora/raw/master/img/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20221022013556.png)





### 4、环境隔离

![微信截图_20221022015622](https://gitee.com/hongshenghyj/typora/raw/master/img/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20221022015622.png)





![微信截图_20221022015816](https://gitee.com/hongshenghyj/typora/raw/master/img/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20221022015816.png)



![微信截图_20221022015839](https://gitee.com/hongshenghyj/typora/raw/master/img/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20221022015839.png)



![微信截图_20221022020224](https://gitee.com/hongshenghyj/typora/raw/master/img/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20221022020224.png)





配置详情

```yaml
server:
  port: 8080
spring:
  datasource:
    url: jdbc:mysql://localhost:3306/cloud_order?useSSL=false
    username: root
    password: 13538026482
    driver-class-name: com.mysql.jdbc.Driver
  application:
      name: orderservice  #order服务的服务名称
  cloud:
    nacos:
      server-addr:  localhost:8848   #配置nacos服务地址\
      #discovery:
       # cluster-name:  HZ  #集群名称
       #namespace: 512f44cf-8cb6-419f-902b-e7e2cf035101  #配置命名空间
       
       
mybatis:
  type-aliases-package: cn.itcast.user.pojo
  configuration:
    map-underscore-to-camel-case: true
logging:
  level:
    cn.itcast: debug
  pattern:
    dateformat: MM-dd HH:mm:ss:SSS

#eureka:
 # client:
  #  service-url:    #eureka地址信息  自己注册自己
   #   defaultZone: http://127.0.0.1:10086/eureka

#配置负载均衡策略
userservice:
  ribbon :
     NFLoadBalancerRuleClassName :  com.netflix.loadbalancer.RandomRule #负载均衡规则

ribbon:
  eager-load:
    enabled: true   #开启饥饿加载
    clients:   #指定服务名称
      - userservice
feign:
  httpclient:
    enabled: true
    max-connections: 200    #最大链接数
    max-connections-per-route:  50  #单个路径最大连接数
```





